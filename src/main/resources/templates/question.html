<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>질문 상세</title>
    <link rel="stylesheet" href="/css/muroba.css">
    <script defer src="/js/question.js"></script>
    <style>
        body { max-width: 600px; margin: 0 auto; padding: 1rem; }
        .comment, .reply { margin-left: 1rem; border-left: 2px solid #eee; padding-left: 1rem; }
        .reply { margin-left: 2rem; }
    </style>
</head>
<body>
    <h2 id="question-title">질문 제목</h2>
    <div id="question-content">질문 내용</div>
    <hr>
    <h3>댓글</h3>
    <div id="comments"></div>
    <script>
    async function loadQuestion() {
        const id = window.location.pathname.split('/').pop();
        const res = await fetch(`/api/questions/${id}`);
        if (res.ok) {
            const q = await res.json();
            document.getElementById('question-title').innerText = q.title || q.content.substring(0, 20);
            document.getElementById('question-content').innerText = q.content;
        }
    }
    async function loadComments() {
        const id = window.location.pathname.split('/').pop();
        const res = await fetch(`/api/answers/question/${id}`);
        if (res.ok) {
            const comments = await res.json();
            const container = document.getElementById('comments');
            container.innerHTML = '';
            comments.forEach(c => {
                const div = document.createElement('div');
                div.className = 'comment';
                div.innerHTML = `<div>${c.comment}</div>`;
                // 대댓글
                if (c.replies && c.replies.length > 0) {
                    c.replies.forEach(r => {
                        const replyDiv = document.createElement('div');
                        replyDiv.className = 'reply';
                        replyDiv.innerText = r.comment;
                        div.appendChild(replyDiv);
                    });
                }
                container.appendChild(div);
            });
        }
    }
    loadQuestion();
    loadComments();
    </script>
</body>
</html> 